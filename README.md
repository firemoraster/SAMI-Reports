# ğŸ“Š SAMI Weekly Reports System

ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚Ğ¸Ğ¶Ğ½ĞµĞ²Ğ¾Ñ— Ğ·Ğ²Ñ–Ñ‚Ğ½Ğ¾ÑÑ‚Ñ– ÑĞ¿Ñ–Ğ²Ñ€Ğ¾Ğ±Ñ–Ñ‚Ğ½Ğ¸ĞºÑ–Ğ² Ğ· Ñ–Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ñ–Ñ”Ñ Telegram-Ğ±Ğ¾Ñ‚Ğ°, Trello Ñ‚Ğ° PDF-ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ–Ğ².

**Tech stack:** TypeScript, Node.js, Telegraf, Express, Sequelize (SQLite), PDFKit, node-cron

## ğŸš€ ĞœĞ¾Ğ¶Ğ»Ğ¸Ğ²Ğ¾ÑÑ‚Ñ–

- **Telegram Bot** â€” Ğ·Ğ±Ñ–Ñ€ Ğ·Ğ²Ñ–Ñ‚Ñ–Ğ² Ñ‡ĞµÑ€ĞµĞ· Ñ‡Ğ°Ñ‚-Ğ±Ğ¾Ñ‚ (Telegraf)
- **PDF Processing** â€” Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ Ñ‚Ğ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ñ–Ñ PDF-Ñ„Ğ¾Ñ€Ğ¼ (pdf-parse, PDFKit)
- **Trello Integration** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğµ ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ ĞºĞ°Ñ€Ñ‚Ğ¾Ğº
- **Statistics** â€” Ğ°Ğ½Ğ°Ğ»Ñ–Ñ‚Ğ¸ĞºĞ° Ñ‚Ğ° Ğ·Ğ²Ñ–Ñ‚Ğ½Ñ–ÑÑ‚ÑŒ
- **REST API** â€” Express API Ğ´Ğ»Ñ Ñ–Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ñ–Ğ¹
- **Scheduler** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ñ– Ğ½Ğ°Ğ³Ğ°Ğ´ÑƒĞ²Ğ°Ğ½Ğ½Ñ (node-cron)

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ

```
SAMI-Reports/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ñƒ
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ index.ts            # Express app
â”‚   â”‚   â””â”€â”€ routes.ts           # API Ñ€Ğ¾ÑƒÑ‚Ğ¸
â”‚   â”œâ”€â”€ bot/
â”‚   â”‚   â”œâ”€â”€ index.ts            # Ğ†Ğ½Ñ–Ñ†Ñ–Ğ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ±Ğ¾Ñ‚Ğ°
â”‚   â”‚   â”œâ”€â”€ handlers.ts         # ĞĞ±Ñ€Ğ¾Ğ±Ğ½Ğ¸ĞºĞ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´
â”‚   â”‚   â”œâ”€â”€ keyboards.ts        # ĞšĞ»Ğ°Ğ²Ñ–Ğ°Ñ‚ÑƒÑ€Ğ¸
â”‚   â”‚   â””â”€â”€ states.ts           # Ğ¡Ñ‚Ğ°Ğ½Ğ¸ Ğ´Ñ–Ğ°Ğ»Ğ¾Ğ³Ñ–Ğ²
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ index.ts            # ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ index.ts            # ĞŸÑ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ Ğ´Ğ¾ Ğ‘Ğ”
â”‚   â”‚   â”œâ”€â”€ models.ts           # Sequelize Ğ¼Ğ¾Ğ´ĞµĞ»Ñ–
â”‚   â”‚   â”œâ”€â”€ crud.ts             # CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ñ–Ñ—
â”‚   â”‚   â””â”€â”€ init.ts             # Ğ†Ğ½Ñ–Ñ†Ñ–Ğ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ‘Ğ”
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ trello.service.ts   # Ğ Ğ¾Ğ±Ğ¾Ñ‚Ğ° Ğ· Trello
â”‚   â”‚   â”œâ”€â”€ pdf.service.ts      # PDF Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³/Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ñ–Ñ
â”‚   â”‚   â”œâ”€â”€ stats.service.ts    # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
â”‚   â”‚   â””â”€â”€ notification.service.ts  # Ğ¡Ğ¿Ğ¾Ğ²Ñ–Ñ‰ĞµĞ½Ğ½Ñ
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts            # TypeScript Ñ‚Ğ¸Ğ¿Ğ¸
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ helpers.ts          # Ğ”Ğ¾Ğ¿Ğ¾Ğ¼Ñ–Ğ¶Ğ½Ñ– Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ—
â”‚       â”œâ”€â”€ validators.ts       # Ğ’Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ Ğ´Ğ°Ğ½Ğ¸Ñ…
â”‚       â”œâ”€â”€ i18n.ts             # Ğ‘Ğ°Ğ³Ğ°Ñ‚Ğ¾Ğ¼Ğ¾Ğ²Ğ½Ñ–ÑÑ‚ÑŒ (uk/en)
â”‚       â”œâ”€â”€ logger.ts           # Winston Ğ»Ğ¾Ğ³ĞµÑ€
â”‚       â””â”€â”€ templates.ts        # Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ğ¸ Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½ÑŒ
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ pdf/                    # PDF ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¸
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ API.md                  # API Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ñ–Ñ
â”‚   â”œâ”€â”€ DEPLOYMENT.md           # Ğ Ğ¾Ğ·Ğ³Ğ¾Ñ€Ñ‚Ğ°Ğ½Ğ½Ñ
â”‚   â””â”€â”€ TRELLO_SETUP.md        # ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Trello
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ ecosystem.config.js         # PM2 ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â””â”€â”€ .env                        # Ğ—Ğ¼Ñ–Ğ½Ğ½Ñ– Ğ¾Ñ‚Ğ¾Ñ‡ĞµĞ½Ğ½Ñ
```

## âš™ï¸ Ğ¨Ğ²Ğ¸Ğ´ĞºĞ¸Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### 1. Ğ’ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹

```bash
cd SAMI-Reports
npm install
```

### 2. ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ

```bash
cp .env.example .env
# Ğ’Ñ–Ğ´Ñ€ĞµĞ´Ğ°Ğ³ÑƒĞ¹Ñ‚Ğµ .env Ñ„Ğ°Ğ¹Ğ» Ğ· Ğ²Ğ°ÑˆĞ¸Ğ¼Ğ¸ ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸
```

### 3. Ğ—Ğ±Ñ–Ñ€ĞºĞ° Ñ‚Ğ° Ğ·Ğ°Ğ¿ÑƒÑĞº

```bash
# Development
npm run dev

# Production
npm run build
npm start

# ĞĞ±Ğ¾ Ñ‡ĞµÑ€ĞµĞ· PM2
pm2 start ecosystem.config.js
pm2 save
```

## ğŸ“± ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸ Ğ±Ğ¾Ñ‚Ğ°

| ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° | ĞĞ¿Ğ¸Ñ |
|---------|------|
| `/start` | Ğ’Ñ–Ñ‚Ğ°Ğ½Ğ½Ñ Ñ‚Ğ° Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ñ |
| `/report` | ĞŸĞ¾Ñ‡Ğ°Ñ‚Ğ¸ ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ Ğ·Ğ²Ñ–Ñ‚Ñƒ |
| `/sendpdf` | ĞĞ°Ğ´Ñ–ÑĞ»Ğ°Ñ‚Ğ¸ Ğ·Ğ°Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ¸Ğ¹ PDF |
| `/myreports` | ĞÑÑ‚Ğ°Ğ½Ğ½Ñ– 5 Ğ·Ğ²Ñ–Ñ‚Ñ–Ğ² |
| `/team` | Ğ—Ğ²Ñ–Ñ‚Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸ (Ğ´Ğ»Ñ ĞºĞµÑ€Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ²) |
| `/stats` | Ğ¨Ğ²Ğ¸Ğ´ĞºĞ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° |
| `/help` | Ğ”Ğ¾Ğ²Ñ–Ğ´ĞºĞ° |

## ğŸ”— API Endpoints

| Method | Endpoint | ĞĞ¿Ğ¸Ñ |
|--------|----------|------|
| GET | `/api/health` | Health check |
| GET | `/api/users` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ñ–Ğ² |
| GET | `/api/users/:id` | ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° |
| PUT | `/api/users/:id` | ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° |
| DELETE | `/api/users/:id` | Ğ’Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° |
| GET | `/api/reports` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ²Ñ–Ñ‚Ñ–Ğ² (Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€Ğ¸: week, year, team, userId) |
| GET | `/api/reports/:id` | ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ğ·Ğ²Ñ–Ñ‚ |
| POST | `/api/reports` | Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ·Ğ²Ñ–Ñ‚ |
| PUT | `/api/reports/:id` | ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ğ·Ğ²Ñ–Ñ‚ |
| DELETE | `/api/reports/:id` | Ğ’Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ğ·Ğ²Ñ–Ñ‚ |
| GET | `/api/reports/:id/pdf` | Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ·Ğ²Ñ–Ñ‚Ñƒ Ğ² PDF |
| GET | `/api/stats/user/:userId` | Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° |
| GET | `/api/stats/team/:team` | Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸ |
| GET | `/api/stats/period` | Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ·Ğ° Ğ¿ĞµÑ€Ñ–Ğ¾Ğ´ |
| GET | `/api/stats/overall` | Ğ—Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° |
| GET | `/api/missing` | Ğ¥Ñ‚Ğ¾ Ğ½Ğµ Ğ·Ğ´Ğ°Ğ² Ğ·Ğ²Ñ–Ñ‚ |
| GET | `/api/settings` | ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ |
| PUT | `/api/settings/:key` | ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ |
| POST | `/api/webhook/trello` | Webhook Trello |

ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ñ–Ñ: Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº `X-API-Key` Ğ°Ğ±Ğ¾ query-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ `apiKey`.

## ğŸ“Š Trello Ğ´Ğ¾ÑˆĞºĞ°

### Ğ¡Ğ¿Ğ¸ÑĞºĞ¸
- ğŸ“¥ NEW REPORTS
- ğŸ‘€ IN REVIEW
- âœ… APPROVED
- âš ï¸ FOLLOW-UP NEEDED
- ğŸ“Š DONE & ARCHIVED

### ĞœÑ–Ñ‚ĞºĞ¸
- ğŸŸ¢ Load: Low (1-2)
- ğŸŸ¡ Load: Medium (3)
- ğŸŸ  Load: High (4)
- ğŸ”´ Load: Critical (5)
- ğŸ”µ Needs Review
- ğŸŸ£ Approved
- âšªï¸ Has Blockers
- â›” Overdue ETA
- âš ï¸ Has Concerns
- ğŸ“ˆ All Tasks Done
- ğŸ† High Performance

## ğŸ“„ Ğ›Ñ–Ñ†ĞµĞ½Ğ·Ñ–Ñ

MIT License

## ğŸ‘¥ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¸


